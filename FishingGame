//Made by Ishan Dutta
//Assistance from Jethro for logic / syntax help

using System;
using System.Collections.Generic;
using static System.Console;

namespace FishingGameFinal
{
    class Program
    {
        static void Main()
        {
            HUD hud = new HUD();
        }
    }

    class Net
    {
        string name;
        string action;
        private string catches;

        HUD hud_;

        Random rng = new Random();

        int check;

        public Net(HUD hud)
        {
            hud_ = hud;
            Clear();

        }

        public string Name { get => name; set => name = value; }
        public string Desc;
        public string Action { get => action; set => action = value; }

        public void Cast()
        {
            Clear();
            ForegroundColor = ConsoleColor.Magenta;
            Desc = "Cast Net: A small round net with weights on the edges.";
            Action = "Action: You lower your fishing rod into the pond and cast a net of 50,000 sq. ft. to capture literally everything.";

            WriteLine(Name + "\n" + Action);
            ResetColor();

            ReadKey();
            Clear();

            ForegroundColor = ConsoleColor.Red;
            catches = "Possible catche results: bluestripe, snapper, surgeonfish, tuna, herring, anchovy, capelin";
            WriteLine(catches);
            ResetColor();

            ReadKey();
            Clear();

            ReadKey();
            Clear();
        }

        public void Durability()
        {
            int[] dmgvalue = { 10, 20, 30, 40, 50, 60, 70, 80, 90 };

            if (check < dmgvalue.Length)
            {
                WriteLine("The current net damage is " + dmgvalue[check] + "%");
            }
            else
            {
                WriteLine("Net is broken");
                Fish.netinv.Remove(this);
                hud_.currentNet = null;
            }

            check++;
        }

        public void Fyke()
        {
            Clear();
            ForegroundColor = ConsoleColor.Magenta;
            Desc = "Fyke: A long cylindrical netting bag";
            Action = "Action: Gently caress your net underwater to get the best results.";

            WriteLine(Name + "\n" + Action);
            ResetColor();

            ReadKey();
            Clear();

            ForegroundColor = ConsoleColor.Red;
            catches = "Possible catch results: eel, plant, trash, nothing";
            WriteLine(catches);
            ResetColor();

            ReadKey();
            Clear();

        }

        public void Hand()
        {
            Clear();
            ForegroundColor = ConsoleColor.Magenta;
            Desc = "Hand net: A long stiff handle with a hooped net at the end";
            Action = "Action: Shove your fist down into the water to use this net.";

            WriteLine(Name + "\n" + Action);
            ResetColor();

            ReadKey();
            Clear();

            ForegroundColor = ConsoleColor.Red;
            catches = "Possible catch results: muskellunge, northern pike, eel, nothing";
            WriteLine(catches);
            ResetColor();

            ReadKey();
            Clear();
        }


    }

    class HUD
    {

        public static bool netExist = false;

        public Net currentNet;

        string input;

        public HUD()
        {
            Net fykeNet = new Net(this);
            Net handNet = new Net(this);

            fykeNet.Name = "Fyke";
            handNet.Name = "Hand";

            Fish.netinv.Add(fykeNet);
            Fish.netinv.Add(handNet);

            menu();
        }

        public void ChooseNet()
        {
            // List of nets
            // Selection of a Net
            if (Fish.netinv.Count == 0)
            {
                WriteLine("There are no nets");
            }
            else
            {
                WriteLine("Select a net:");
                int index = 1;
                foreach (Net net in Fish.netinv)
                {
                    WriteLine(index + net.Name);
                    index++;
                }

                int digitInput = 0;
                while (true) // get the digit input
                {
                    string input = ReadLine();

                    bool isValid = true;

                    try
                    {
                        digitInput = Convert.ToInt32(input);
                    }
                    catch
                    {
                        isValid = false;
                    }

                    if (isValid)
                    {
                        if (digitInput > 0 && digitInput <= Fish.netinv.Count)
                        {
                            break;
                        }
                    }
                }

                switch (Fish.netinv[digitInput - 1].Name)
                {
                    case "Fyke":
                        Fish.netinv[digitInput - 1].Fyke();
                        break;
                    case "Hand":
                        Fish.netinv[digitInput - 1].Hand();
                        break;
                    case "Cast":
                        Fish.netinv[digitInput - 1].Cast();
                        break;
                }
                currentNet = Fish.netinv[digitInput - 1];
            }

            WriteLine("The current selected net is: " + currentNet.Name);
            WriteLine("Press enter to clear..");
            ReadKey();
            Clear();
        }

        public void menu()
        {
            string input;
            while (true)
            {

                try
                {

                    WriteLine("Please select from one of the three option?");

                    ForegroundColor = ConsoleColor.Gray;
                    WriteLine("(It is advised to select the net type first before proceeding)\n");
                    ResetColor();

                    WriteLine("1) Net Type\n2) Fish\n3) Inventory\n4) Store\n5) Exit");


                    input = ReadLine();

                    if (input == "1")
                    {
                        ChooseNet();

                        ForegroundColor = ConsoleColor.Cyan;
                        WriteLine($"Your current net selected is: {currentNet.Name}");
                        ResetColor();
                    }
                    else if (input == "2")
                    {
                        if (currentNet == null)
                        {
                            throw new NotImplementedException();
                        }
                        else
                        {
                            Fish fish = new Fish(currentNet);

                            ForegroundColor = ConsoleColor.Cyan;
                            WriteLine($"Your current net selected is: {fish.nameofnet}");
                            WriteLine($"Your current fish selected is: {fish.FishName}");
                            ResetColor();
                        }

                    }
                    else if (input == "3")
                    {
                        ForegroundColor = ConsoleColor.Red;
                        WriteLine("Inventory:");
                        ResetColor();
                        foreach (string print in Fish.inventory)
                        {
                            WriteLine(print + "\n");
                        }
                        ReadKey();
                    }
                    else if (input == "4")
                    {
                        Store st = new Store(this);
                    }
                    else if (input == "5")
                    {
                        Environment.Exit(0);
                    }
                    else
                    {

                    }
                }
                catch
                {
                    throw new NotImplementedException();
                }
            }
        }
    }

    class Fish
    {
        public static List<string> inventory = new List<string>();
        public static List<Net> netinv = new List<Net>();

        Random rng = new Random();

        public string fishname;
        public string nameofnet;

        public string FishName { get => fishname; set => fishname = value; }

        private Net currentNet;

        public Fish(Net net_)
        {
            nameofnet = net_.Name;
            currentNet = net_;
            Clear();

            Options();

        }

        public void Options()
        {
            Time();
            Console.ReadKey();
            Clear();

            WriteLine("You are currently fishing...");

            if (nameofnet == "Fyke")
            {
                string[] items1 = { "eel", "plant", "trash", "nothing" };
                string items1Choice = items1[rng.Next(items1.Length)];
                Console.WriteLine($"You raise your Fyke out, and have caught... a {items1Choice} ");
                fishname = items1Choice;

                if (fishname != "nothing")
                {
                    inventory.Add(fishname);
                }
            }

            else if (nameofnet == "Hand")
            {
                string[] items2 = { "muskellunge", "northern pike", "eel", "nothing" };
                string items2Choice = items2[rng.Next(items2.Length)];
                Console.WriteLine($"You raise your Hand out, and have caught... a {items2Choice} ");
                fishname = items2Choice; // not showing cuz out of scope

                if (fishname != "nothing")
                {
                    inventory.Add(fishname);
                }
            }
            else if (nameofnet == "Cast")
            {
                string[] items0 = { "bluestripe", "snapper", "surgeonfish", "tuna", "herring", "anchovy", "capelin" };
                string items2Choice = items0[rng.Next(items0.Length)];
                Console.WriteLine($"You raise your Cast out, and have caught... a {items2Choice} ");
                fishname = items2Choice;

                if (fishname != "nothing")
                {
                    inventory.Add(fishname);
                }
            }

            currentNet.Durability();

            WriteLine("Press enter to clear..");
            ReadKey();
            Clear();
        }
        public void Time()
        {
            Console.ForegroundColor = ConsoleColor.Red;
            int[] time = { 2, 3, 4, 5 };
            int timeInt = time[rng.Next(time.Length)];
            Console.WriteLine($"{timeInt} minutes have passed.");
            ResetColor();
        }
    }

    class Store
    {
        public Store(HUD h)
        {
            hud = h;
            option();
        }

        private HUD hud;

        public int coins;

        public string choice;

        public void option()
        {
            while (true)
            {
                WriteLine("Do you want to\n1) Buy\n2) Sell\n3) Leave");
                choice = ReadLine();

                if (choice == "1")
                {
                    Clear();
                    WriteLine("You have chosen to buy things from the store!\n");
                    Write("You can currently buy the ");
                    ForegroundColor = ConsoleColor.Red;
                    Write("1) Cast Net\n");
                    Write("2) Fyke Net\n");
                    Write("3) Hand Net\n");
                    ResetColor();

                    ForegroundColor = ConsoleColor.Cyan;
                    WriteLine("Each will cost you 5 coins\n");
                    ResetColor();
                    WriteLine("What would you like to buy?\n1) Cast\n2) Fyke\n3) Hand");

                    choice = ReadLine();

                    if (choice == "1" & coins >= 5)
                    {
                        WriteLine("You have bought the Cast Net!");
                        Net net = new Net(hud);
                        net.Name = "Cast";
                        Fish.netinv.Add(net);
                        ReadKey();
                    }
                    else if (choice == "2" & coins >= 5)
                    {
                        WriteLine("You have bought the Fyke Net!");
                        Net net = new Net(hud);
                        net.Name = "Fyke";
                        Fish.netinv.Add(net);
                        ReadKey();
                    }
                    else if (choice == "3" & coins >= 5)
                    {
                        WriteLine("You have bought the Hand Net!");
                        Net net = new Net(hud);
                        net.Name = "Hand";
                        Fish.netinv.Add(net);
                        ReadKey();
                    }
                    else
                    {
                        WriteLine("You don't have enough coins!");
                    }
                }
                else if (choice == "2")
                {
                    Clear();
                    WriteLine("You have chosen to sell things from the store!\n");
                    Write("You currently have ");
                    Write(Fish.inventory.Count);
                    Write(" items to sell.\n");

                    ReadKey();
                    Clear();

                    Write("You have received ");
                    Write(Fish.inventory.Count);
                    Write(" coins.\n");

                    coins = Fish.inventory.Count;
                    Fish.inventory.Clear();
                }
                else if (choice == "3")
                {
                    break;
                }
            }
        }

    }
}
